# Enhanced DataRobot Lineage Graph

## üéØ **Overview**

The enhanced DataRobot lineage graph now provides **rich, typed relationships** between assets, making it dramatically easier to understand dependencies, troubleshoot issues, and analyze impact across your ML ecosystem.

## üîó **Enhanced Edge Types**

### **üü† Application Relationships**
- **`USES_DEPLOYMENT`** - App uses a specific model deployment
- **`USES_MODEL`** - App directly references a trained model  
- **`BUILT_FROM_PROJECT`** - App was built from an ML project
- **`REFERENCES_DATASET`** - App references specific datasets
- **`USES_VECTOR_DB`** - App uses vector database for RAG/search
- **`USES_REGISTERED_MODEL`** - App uses registered model
- **`BUILT_FROM_SOURCE`** - App built from source code

### **üîµ ML Pipeline Relationships**
- **`TRAINED_ON`** - Model trained on specific dataset
- **`BELONGS_TO_PROJECT`** - Model belongs to ML project
- **`DEPLOYS_MODEL`** - Deployment serves specific model
- **`DEPLOYS_REGISTERED_MODEL`** - Deployment serves registered model
- **`REGISTERED_FROM`** - Registered model created from model

### **üü¢ Data Flow Relationships**
- **`SOURCED_FROM`** - Dataset sourced from external data
- **`CONNECTS_TO`** - Datasource connects to datastore
- **`PROCESSES_DATA_FROM`** - Recipe processes data from source
- **`PROCESSED_BY`** - Dataset processed by recipe
- **`GENERATED_BY_QUERY`** - Dataset generated by query

### **üü£ AI & LLM Relationships**
- **`BUILT_FROM_DATASET`** - Vector DB built from dataset
- **`USES_LLM`** - Blueprint uses Large Language Model
- **`USES_LLM_BLUEPRINT`** - Custom model uses LLM blueprint
- **`CONFIGURED_IN_PLAYGROUND`** - Blueprint configured in playground
- **`EXPERIMENTS_WITH`** - Playground experiments with LLM

## üìä **Node Types (17 Total)**

### **üü¢ Data & Storage (5 types)**
- **`datasets`** - Primary training/validation datasets
- **`datastore`** - External data storage (DB, S3, etc.)
- **`datasource`** - Specific data source within datastore
- **`vectorDatabases`** - Vector databases for embeddings
- **`dataEngineQueries`** - Data processing queries

### **üîµ Projects & Models (4 types)**
- **`projects`** - ML/AI projects
- **`models`** - Trained ML models
- **`customModelVersion`** - Custom model versions
- **`registeredModels`** - Models in model registry

### **üü£ AI & LLM (3 types)**
- **`llm`** - Large Language Models
- **`llmBlueprint`** - LLM configuration blueprints
- **`playgrounds`** - AI experimentation environments

### **üü† Applications (3 types)**
- **`applications`** - DataRobot applications
- **`customApplications`** - Custom applications
- **`customApplicationSources`** - Application source code

### **üü§ Processing & Deployment (2 types)**
- **`deployments`** - Model deployments
- **`recipes`** - Data processing pipelines

## üé® **Visual Enhancements**

### **Color Coding**
- **Orange family** - Application relationships (thicker lines)
- **Blue family** - Core ML pipeline
- **Green family** - Data relationships
- **Purple family** - AI/LLM relationships
- **Gray** - Default/generic relationships

### **Line Styling**
- **Width** - Indicates importance (1-3px)
  - 3px: Critical app relationships (`USES_DEPLOYMENT`, `USES_MODEL`)
  - 2px: Core ML pipeline (`TRAINED_ON`, `DEPLOYS_MODEL`)
  - 1px: Data connections
- **Dashes** - Special relationship types
  - Dashed: References (`REFERENCES_DATASET`)
  - Dotted: Vector relationships (`USES_VECTOR_DB`)

### **Enhanced UI Components**

#### **üé® Node Color Legend**
- Expandable legend showing all node types
- Live node counts per category
- Search functionality to find specific nodes
- Mini mode toggle for clean overview

#### **üîó Edge Type Legend**  
- Visual representation of edge types with colors/styles
- Categorized by relationship type
- Live edge counts
- Line thickness and dash patterns shown

#### **üîç Advanced Search**
- Search by node ID, name, or type
- Auto-zoom to found nodes
- Golden highlight with pulse animation
- Search result display

## üöÄ **Application Lineage Features**

### **Enhanced Application Nodes**
```json
{
  "id": "app-customer-churn-predictor",
  "label": "applications",
  "name": "Customer Churn Predictor App",
  "applicationTypes": ["deployment", "dataset"],
  "deploymentIds": ["deploy-churn-model-v2"],
  "relatedEntities": {
    "modelId": "model-churn-rf-789", 
    "projectId": "proj-churn-analysis-456"
  },
  "referencedDatasets": [{
    "datasetId": "dataset-customer-data-123",
    "versionId": "v3"
  }]
}
```

### **Rich Edge Properties**
```json
{
  "from": "deploy-churn-model-v2",
  "to": "app-customer-churn-predictor",
  "type": "USES_DEPLOYMENT",
  "label": "USES_DEPLOYMENT", 
  "color": "#FF6B35",
  "width": 3,
  "dashes": false
}
```

## üíº **Business Value**

### **üîç Impact Analysis**
- **"What apps will break if I change this model?"** - Follow `USES_MODEL` edges
- **"Which datasets does this app depend on?"** - Trace `REFERENCES_DATASET` paths
- **"What's the full pipeline behind this deployment?"** - Follow `DEPLOYS_MODEL` ‚Üí `TRAINED_ON` chain

### **üõ†Ô∏è Troubleshooting**
- **Clear dependency visualization** - No more guessing about relationships
- **Root cause analysis** - Trace issues back through typed connections
- **Performance optimization** - Identify bottlenecks in data pipelines

### **üìã Governance & Compliance**
- **Data lineage tracking** - Full path from source to application
- **Model governance** - Clear model ‚Üí deployment ‚Üí application mapping
- **Change impact assessment** - Understand downstream effects

## üîß **Technical Implementation**

### **Edge Type Mapping**
```javascript
const edgeTypeMap = {
  'applications-deployments': 'USES_DEPLOYMENT',
  'applications-models': 'USES_MODEL',
  'datasets-projects': 'TRAINED_ON',
  'models-deployments': 'DEPLOYS_MODEL',
  // ... 25+ mappings total
};
```

### **Enhanced Application Processing**
- **Direct relationships** - Model, project, deployment links
- **Dataset references** - Explicit dataset dependencies  
- **Vector DB inference** - Smart detection of vector search usage
- **Source code tracking** - Custom application source lineage

### **Custom Model Version Configuration Parsing**
- **Configuration field extraction** - Parse `runtimeParameters` from API
- **Vector database relationships** - `VECTOR_DATABASE_ID` ‚Üí `USES_VECTOR_DB`
- **Deployment relationships** - `VECTOR_DATABASE_DEPLOYMENT_ID` ‚Üí `USES_DEPLOYMENT`
- **LLM blueprint relationships** - `LLM_BLUEPRINT_ID` ‚Üí `USES_LLM_BLUEPRINT`
- **Playground relationships** - `PLAYGROUND_ID` ‚Üí `CONFIGURED_IN_PLAYGROUND`
- **Smart field mapping** - Automatic detection of relationship fields
- **Graceful error handling** - Continue processing if relationships fail

### **Visual Processing**
- **Real-time node coloring** - Based on node.label
- **Dynamic edge styling** - Width, color, dash patterns
- **Search highlighting** - Golden pulse animation
- **Tooltip enhancement** - Rich hover information

## üìà **Performance & Scalability**

- **Efficient edge processing** - O(n) complexity for edge typing
- **Smart caching** - Node color calculations cached
- **Lazy loading** - Legends only show when data available
- **Memory optimization** - useMemo for expensive calculations

## üéØ **Example Use Cases**

### **1. Application Impact Analysis**
```
Question: "What happens if I retrain model-churn-rf-789?"
Answer: Follow edges ‚Üí deploy-churn-model-v2 ‚Üí app-customer-churn-predictor
Impact: 1 deployment + 1 application affected
```

### **2. Data Lineage Tracking**  
```
Question: "Where does app data come from?"
Answer: app ‚Üí REFERENCES_DATASET ‚Üí dataset ‚Üí SOURCED_FROM ‚Üí datasource ‚Üí CONNECTS_TO ‚Üí datastore
Full Path: PostgreSQL ‚Üí CRM Table ‚Üí Customer Data ‚Üí Churn Project ‚Üí RF Model ‚Üí Deployment ‚Üí App
```

### **3. Model Governance**
```
Question: "Which apps use registered models?"
Answer: Filter edges by USES_REGISTERED_MODEL type
Result: Direct visibility into model registry usage
```

## üîÑ **Migration Path**

### **Backward Compatibility**
- All existing `IS_PARENT_OF` edges preserved
- New typed edges added alongside
- UI gracefully handles mixed edge types

### **Gradual Enhancement**  
- Start with application edges (highest value)
- Expand to ML pipeline relationships
- Add data flow typing last

### **API Versioning**
- `/getUseCaseGraph?version=v2` - Enhanced edges
- `/getUseCaseGraph` - Legacy format maintained
- Automatic detection and upgrading

---

**This enhancement transforms the DataRobot lineage graph from a generic dependency view into a rich, semantic representation of your ML ecosystem that directly supports business decision-making and operational excellence.** 